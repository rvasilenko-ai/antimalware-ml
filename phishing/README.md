# Phishing

### Overview 

Detection of Phishing emails, email attachments and URLs is one of the main challenges in Cyber Secutiry. Social Engineering has been and always will be one the the most efficient ways to compromise an organization or individual, and Phishing is a very effective form of Social Engineering.

According to Wiki, phishing is "the fraudulent attempt to obtain sensitive information such as usernames, passwords and credit card details by disguising oneself as a trustworthy entity in an electronic communication. Typically carried out by email spoofing or instant messaging, it often directs users to enter personal information at a fake website which matches the look and feel of the legitimate site." (more details [here](https://en.wikipedia.org/wiki/Phishing))

Most often the final destination of a phishing email, message or document is a fraudulent web-page, which imitates a legitimate page. One of the main difficulty in detection of such web sites is the fact that they don't do anything explicitly malicious: they don't encrypt files, delete them nor upload them to malicious server. Instead phishing website pretents to be legitimate business and ask user to share credentials or sensitive information.

How to figure out if a website which asks for password is fraudulent or not? That is not an easy task.
There are a lot of methods based on analysis of URL itself or the source code of phishing website, but today, we will focus on methods based on visual analysis of the website.

### Image-based Phishing detection

Instead of trying to understand a phishing attack based on technical details in the source code of the website or its URL, that we found that the most promising approach is to look at the phishing attack as the victim sees it: analyze a visual appearance of a website and detect if a page tries to imitate a legitimate one.

But how can we say that a page tries to imitate another page? 

For that, we need to build a knowledge base of high reputation legitimate pages and analyze now much a given low reputation web page is similar to well known one. In a lot of cases an attacker is not really using a complete copy of the legitimate website though, but using a web page which "appears to be" a legitimate web site. It happens either because an attacker is not quick enough to adopt new changes from legitimate web site or because he or she chose to imitate rather than create an identical copy from the beginning. Even though it seems that this might complicate detection by similarity, it is actually quite opposite, since in such cases we don't even need to be concern about potential false positive when we accidentally might detect a legitimate web site as phishing, and only need to observe phishing website ones to create detection.

To read more about Phishing and why Image based detection is very efficient, visit article from Tobias Jarmuzek, a threat researcher and developer at Lastline, [here](https://www.lastline.com/blog/image-recognition-to-spot-elusive-phishing-attacks/)


### Cryptographic hashes vs. image hashes
To build described knowledge base, we need a way to recognize compute similarity of visual appearance. A common way of doing it is to take a screenshot of the web page, and compute a hash of it to uniquely identify it. In most of the time, when someone says "hash", they mean a cryptographic hash such as md5 or sha1. However, a cryptographic hash is not a good option for our purpose, since even slight modification of the web-site, like a text change or banner update will completely change the hash.

Instead, we need a hash algorithm which computes a hash of the image in a way, that similar images have similar hashes. 

Luckily for us, such image hashes exist!
For example:

*   [phash (perception hashing)](https://realpython.com/fingerprinting-images-for-near-duplicate-detection/)
*   [simhash](https://www.researchgate.net/publication/261314326_Efficient_near-duplicate_document_detection_using_FPGAs)
*   [ahash (average hashing)](http://www.hackerfactor.com/blog/index.php?/archives/432-Looks-Like-It.html)
*   [dhash (difference hashing)](http://www.hackerfactor.com/blog/index.php?/archives/529-Kind-of-Like-That.html)
*   [whash (wavelet hashing)](https://fullstackml.com/wavelet-image-hash-in-python-3504fdd282b5)

Our of the list, perception hashing (or pHash) seems to be the most promising for our goal, since it is very tolerant of minor modifications (minor being less than 25% of the picture). So if a banner or text on web site gets updates, we still will be find similarity.

In a section "pHashClustering", we will explore how well pHash performs for phishing website similarities using dataset shared by Claudio "nex" Guarnieri [here](https://nex.sx/blog/2019/12/15/the-year-of-the-phish.html).

Then we will learn concepts of Transfer learning, Siamese Neural Networks, and Autoencoders to come up with even smarter hashing methods in section "PhishNet".
