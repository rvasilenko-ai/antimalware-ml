# Phishing

### Overview 

Detection of Phishing emails, email attachments and URLs is one of the main challenges in Cyber Secutiry. Social Engineering has been and stays on the the most efficient ways to compromise an organization or individual, and Phishing is big part of it.

According to Wiki, phishing is "the fraudulent attempt to obtain sensitive information such as usernames, passwords and credit card details by disguising oneself as a trustworthy entity in an electronic communication. Typically carried out by email spoofing or instant messaging, it often directs users to enter personal information at a fake website which matches the look and feel of the legitimate site." (more details here)

Most often the final destination of a phishing email, message or document is a fraudulent web-page, which imitates a legitamate page. One of the main difficulty in detection of such web sites is the fact that they don't do anything explicitely malicious. How to distinguish if a web site which ask for password is fraudulent or not?

### Image-based Phishing detection

Instead of trying to understand a phishing attack based on technical details in the source code of the website or its URL, that most promissing approach is to look at the phishing attack as the victim sees it: analyze the visual appearance of a website and detect if a page tries to imitate a legitimate one.

But how can we say that a page tries to imitage another page? 

For that, we need to build a knowledge base of legitamate pages and analyze now much a new low reputation web-page is similar to well known one. In a lot of cases an attacker is not really using a complete copy of the legitamate web site though, but instead using a web page which "appears to be" a legitamate web site. It happens either because an attacker is not quick enough to adopt new changes from legitamate web site or becasue he or she chose to imitate rather than create an identical copy from the beginnig. Even though it seems that this might complicate detection by similarity, it is actually quite opposite, since in such cases we don't even need to be concern about potential false positive when we excidenatly might detect a legitamate web site as phishing.

To read more about Phishing and why Image based detection is very efficient, visit article from aTobias Jarmuzek, a threat researcher and developer at Lastline, [here](https://www.lastline.com/blog/image-recognition-to-spot-elusive-phishing-attacks/)


### Smart image hashes
To build described knowledge base, we need a way to recognize compute similarity of visual appearance. A common way of doing it is to take a screenshot of the web-page, and compute a hash of it to uniquly identify it. A regular hash such as md5 or sha1 is not a good option however, since even slight modification of the web-site, like a text change or banner update will completely change the hash.

Instead, a "smarter" versions of hash algorithms are used to compute a hash of the image in a way, that similar images have similar hashes.

For example:

*   [phash (perception hashing)](https://realpython.com/fingerprinting-images-for-near-duplicate-detection/)
*   [simhash](https://www.researchgate.net/publication/261314326_Efficient_near-duplicate_document_detection_using_FPGAs)
*   [ahash (average hashing)](http://www.hackerfactor.com/blog/index.php?/archives/432-Looks-Like-It.html)
*   [dhash (difference hashing)](http://www.hackerfactor.com/blog/index.php?/archives/529-Kind-of-Like-That.html)
*   [whash (wavelet hashing)](https://fullstackml.com/wavelet-image-hash-in-python-3504fdd282b5)

Our of the list, phash seems to be the most promising for our goal, since it is very tolerant of minor modifications (minor being less than 25% of the picture). So if a banner or text on web site gets updates, we still will be find similarity.

In section, "KMeans Clustering", we will explore how well phash performs for phishing web-site similarities using data set shared by Claudio "nex" Guarnieri [here](https://nex.sx/blog/2019/12/15/the-year-of-the-phish.html).

Then we will try to use concept of Autoencoders and Saimese Neural Networks to come up with even smarter hash in section "PhishNet".
